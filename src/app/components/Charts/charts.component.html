<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 hidden">
  <div class="flex items-center">
    <input id="Expense" name="chartView" type="radio" [value]="'expense'" [(ngModel)]="chartView"
      (ngModelChange)="loadChart()" class="focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300" />
    <label for="Expense" class="ml-2 block text-sm text-gray-900 dark:text-gray-200">Expense</label>
  </div>
  <div class="flex items-center">
    <input id="Income" name="chartView" type="radio" [value]="'income'" [(ngModel)]="chartView"
      (ngModelChange)="loadChart()" class="focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300" />
    <label for="Income" class="ml-2 block text-sm text-gray-900 dark:text-gray-200">Income</label>
  </div>
  <div class="flex items-center">
    <input id="Summary" name="chartView" type="radio" [value]="'summary'" [(ngModel)]="chartView"
      (ngModelChange)="loadChart()" class="focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300" />
    <label for="Summary" class="ml-2 block text-sm text-gray-900 dark:text-gray-200">Summary</label>
  </div>
</div>

<ng-container #chartContainer></ng-container>
<ng-template #chartTemplate>
  <h2 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">{{ chartType }}</h2>
  <div
    class="w-full h-[350px] relative bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl overflow-hidden flex items-center justify-content">



    <div class="ml-6" [ngClass]="tooltipVisible ? 'visible': 'invisible'">
      <h2 class="text-white text-2xl font-semibold mb-2">{{ tooltipLabel }}</h2>
      <div class="text-white text-2xl">
        ₹ <span id="percentageText" #percentageText></span>
      </div> <!-- ₹ {{ tooltipValue | number:'1.2-2' }} -->
    </div>

    <canvas #chartCanvas class="max-w-[500px] max-h-[500px] cursor-pointer" (mousemove)="onCanvasMouseMove($event)"
      (mouseleave)="onCanvasMouseLeave()"></canvas>

    <!-- Tooltip -->
    <div *ngIf="tooltipVisible"
      class="absolute bg-gray-900 text-white px-4 py-2 rounded-lg shadow-xl pointer-events-none transition-opacity duration-200"
      [style.left.px]="tooltipX" [style.top.px]="tooltipY" [style.opacity]="tooltipVisible ? 1 : 0">
      <div class="font-semibold text-sm">{{ tooltipLabel }}</div>
      <div class="text-xs text-gray-300">{{ tooltipPercentage }} %</div>
    </div>

    <div class="absolute top-5 right-5 bg-white/95 p-5 rounded-lg shadow-lg h-[320px] overflow-y-auto">
      <div *ngFor="let item of chartData; let i = index"
        class="flex items-center mb-3 cursor-pointer transition-transform duration-200 hover:translate-x-1"
        (mouseenter)="onLegendHover(i)" (mouseleave)="onLegendLeave(i)">
        <span class="w-5 h-5 rounded inline-block mr-2.5" [style.background-color]="item.color"></span>
        <span class="font-medium text-sm text-gray-800">{{ item.category }}: {{ item.percentage }} %</span>
      </div>
    </div>
  </div>
</ng-template>

